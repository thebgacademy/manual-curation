// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/docker-existing-dockerfile
{
	"name": "Existing Dockerfile",
	"build": {
		// Sets the run context to one level up instead of the .devcontainer folder.
		"context": "..",
		// Update the 'dockerFile' property if you aren't using the standard 'Dockerfile' filename.
		"dockerfile": "Dockerfile"
	},
	"features": {
		"ghcr.io/devcontainers/features/desktop-lite:1": {
			"version": "latest",
			"noVncVersion": "1.2.0",
			"password": "password",
			"webPort": "6080",
			"vncPort": "5901"
		},
		"ghcr.io/rocker-org/devcontainer-features/miniforge:1": {
			"version": "latest",
			"variant": "Mambaforge"
		},
		"ghcr.io/wxw-matt/devcontainer-features/apt:latest": {
			"packages": "vim"
        },
		"ghcr.io/wxw-matt/devcontainer-features/command_runner:latest": {
			"command1": "mamba create -n rapid -c bioconda perl-bioperl seqtk python=3.10 pyfastaq -y",
		}
	},

	// Use 'forwardPorts' to make a list of ports inside the container available locally.
	"forwardPorts": [6080, 8321],

	"portsAttributes": {
		"6080": {
			"label": "Desktop access (password: vscode)",
			"onAutoForward": "silent"
		},
		"5901": {
			"label": "VNC TCP port (password: vscode)",
			"onAutoForward": "silent"
		}
	},

	"postCreateCommand": "/opt/conda/envs/rapid/bin/pip3 install click ruff && sudo /opt/conda/envs/rapid/bin/pip3 install ../../agp-tpf-utils/ && unzip ../../PretextView_Linux-x86-64.zip"

}
